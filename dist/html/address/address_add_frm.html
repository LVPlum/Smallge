<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>input::-webkit-input-placeholder,textregion::-webkit-input-placeholder{color:#ccc}input:-moz-placeholder,textregion:-moz-placeholder{color:#ccc}input:-ms-input-placeholder,textregion:-ms-input-placeholder{color:#ccc}.aui-list.aui-list-in .aui-list-item{background-position:0 bottom}.hide{opacity:0}</style> </head> <body> <div id=app v-cloak> <ul class="aui-list aui-list-in aui-form-list aui-list-noborder"> <li class=aui-list-item> <div class=aui-list-item-inner> <div class=aui-list-item-label tapmode onclick=openWinPlateProvince() style=width:4rem>姓名</div> <div class="aui-list-item-input aui-padded-l-15"> <input type=text placeholder=请输入您的姓名 v-model=name> </div> </div> </li> <li class=aui-list-item> <div class=aui-list-item-inner> <div class=aui-list-item-label tapmode onclick=openWinPlateProvince() style=width:4rem>手机号码</div> <div class="aui-list-item-input aui-padded-l-15"> <input type=tel placeholder=请输入您的手机号码 v-model.trim=tel> </div> </div> </li> <li class=aui-list-item tapmode @click=openFrmRegion> <div class="aui-list-item-inner aui-list-item-arrow aui-margin-r-15"> <div class=aui-list-item-label style=width:4rem>所在区域</div> <div class="aui-pull-right aui-margin-r-15 aui-ellipsis-1" :class="region ? '' : 'tea-text-gray' ">{{ region ? region : '请选择' }}</div> </div> </li> <li class=aui-list-item> <div class=aui-list-item-inner> <textarea placeholder=请填写详细地址 v-model=" detail "></textarea> </div> </li> </ul> </div> </body> <script src=../../script/api.js></script> <script src=../../script/conn.js></script> <script src=../../script/fastclick.min.js></script> <script src=../../script/vue.min.js></script> <script src=../../script/tea.js></script> <script type=text/template id=template> </script> <script>function init(){dom={},vm=new Vue({el:"#app",data:{name:"",tel:"",region:"",detail:"",selectedInfo:[19,4,4]},methods:{openFrmRegion:function(){openFrmSelect()}},computed:{errorMsg:function(){var e=new tea.checkRule;return e.add(this.name,[{condition:"isNoEmpty",errorMsg:"请输入姓名"}]),e.add(this.tel,[{condition:"isPhone",errorMsg:"请输入正确的手机号码"}]),e.add(this.region,[{condition:"isNoEmpty",errorMsg:"请选择区域"}]),e.add(this.detail,[{condition:"isNoEmpty",errorMsg:"请输入详细地址"}]),e.start()}},watch:{initialize:{handler:function(){api.pageParam.value&&(this.name=api.pageParam.value.name,this.tel=api.pageParam.value.tel,this.region=api.pageParam.value.region,this.detail=api.pageParam.value.detail,this.selectedInfo=api.pageParam.value.region_code.split(","))},immediate:!0},errorMsg:{handler:function(){api.sendEvent({name:"isReady",extra:{errorMsg:this.errorMsg}})},immediate:!0}}}),initModule(),initEventListener()}function initModule(){}function initEventListener(){}function getData(){}function postData(){if(vm.errorMsg)return api.toast({msg:vm.errorMsg,duration:2e3,location:"middle"}),!1;api.ajax({url:website+"exempt_api.php?action=newaddr",method:"post",timeout:30,data:{values:{ID:$api.getStorage("ID"),name:vm.name,tel:vm.tel,region:vm.region,region_code:vm.selectedInfo.join(","),detail:vm.detail}}},function(e,i){if(!e)return!1;"1"==e.succ&&(api.sendEvent({name:"saveOk",extra:{key1:"value",key2:"value"}}),api.closeToWin({name:api.pageParam.origin,animation:{type:"flip",subType:"from_bottom",duration:500}}))})}function editorAdd(){api.ajax({url:website+"exempt_api.php?action=editaddr",method:"post",timeout:30,data:{values:{ID:$api.getStorage("ID"),addrid:api.pageParam.value.addrid,name:vm.name,tel:vm.tel,region:vm.region,region_code:vm.selectedInfo.join(","),detail:vm.detail}}},function(e,i){if(!e)return!1;"1"==e.succ&&(api.sendEvent({name:"editorOk",extra:{addrid:api.pageParam.value.addrid}}),api.closeToWin({name:api.pageParam.origin,animation:{type:"flip",subType:"from_bottom",duration:500}}))})}function openFrmSelect(){api.require("UIActionSelector").open({datas:"widget://html/address/city_new.json",layout:{row:5,col:3,height:40,size:12,sizeActive:14,rowSpacing:5,colSpacing:10,maskBg:"rgba(0,0,0,0.6)",bg:"#ededed",color:"#999",colorSelected:"#333"},animation:!0,cancel:{text:"取消",size:16,w:90,h:35,bg:"#f5f5f5",bgActive:"#f5f5f5",color:"#3399ff",colorActive:"#3399ff"},ok:{text:"完成",size:16,w:90,h:35,bg:"#f5f5f5",bgActive:"#f5f5f5",color:"#3399ff",colorActive:"#3399ff"},title:{text:"",size:12,h:44,bg:"#f5f5f5",color:"#888"},actives:vm.selectedInfo},function(e,a){if("ok"==e.eventType){var t=[],n="";for(i in e.selectedInfo)n+=e.selectedInfo[i].name,t.push(e.selectedInfo[i].index);vm.region=n,vm.selectedInfo=t}})}var dom={},data={},vm=null;apiready=function(){init()}</script> </html>