<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <link rel=stylesheet type=text/css href=../../css/account.css /> <style type=text/css>header{margin:5rem auto .5rem}header img{height:3.7rem;width:3.7rem;margin:auto;margin-bottom:.5rem;border-radius:50%}header p{font-size:1rem;color:#333}.btn-code{width:7.5rem}</style> </head> <body> <div id=app v-cloak> <header> <img src=../../image/logo108.png> <p>{{ tel.replace(/(\d{3})\d{4}(\d{4})/, "$1****$2") }}</p> </header> <ul class="aui-list aui-form-list aui-list-noborder" v-show="type == 'code'"> <li class="aui-list-item aui-padded-l-10"> <div class=aui-list-item-inner> <div class="aui-list-item-input aui-font-size-16"> <input id=code type=tel placeholder=请输入短信验证码 maxlength=6 v-model=code @keyup.enter=submit> </div> <div class="btn-code aui-border-l aui-text-center aui-font-size-16 tea-text-default" :class="{'tea-text-red' : time == 0 || time == '获取验证码'}" @click=sendCode()> {{ formatTime }} </div> </div> </li> </ul> <label for=password v-show="type == 'password'"> <i class="aui-iconfont tea-icon-lock icon-left"></i> <input id=password :type="display? 'text' : 'password'" placeholder=请输入您的密码 maxlength=15 :class="{ 'center': password }" v-model=password @keyup.enter=submit> <i class="aui-iconfont tea-icon-display icon-right" :class="{ 'aui-hide' : !password}" @click=toggleDisplay()></i> </label> <p class="tea-text-blue aui-font-size-16 aui-text-left aui-margin-l-10 aui-margin-t-15" @click=toggleType()>{{type == 'code'? '用密码登录' : '用验证码登录'}}</p> <footer class="aui-margin-t-10 aui-margin-b-0"> <div class="aui-btn aui-btn-block tea-btn-submit" :class="{'tea-active' : !errorMsg}" @click=submit()>登录</div> </footer> </div> </body> <script src=../../script/api.js></script> <script src=../../script/conn.js></script> <script src=../../script/fastclick.min.js></script> <script src=../../script/vue.min.js></script> <script src=../../script/account.js></script> <script src=../../script/tea.js></script> <script type=text/template id=template> </script> <script>function init(){dom={};var e=$api.getStorage("tel")?$api.getStorage("tel"):"";e=api.pageParam.tel?api.pageParam.tel:e,vm=new Vue({el:"#app",data:{type:"password",display:!1,tel:e,password:"",code:"",time:"获取验证码",count:60,sending:!1},methods:{clear:function(e){this[e]=""},toggleType:function(){"code"==this.type?this.type="password":this.type="code"},toggleDisplay:function(){this.display=!this.display},submit:function(){if(vm.errorMsg)return api.toast({msg:vm.errorMsg,duration:2e3,location:"middle"}),!1;"password"==this.type?account.loginByPassword():account.loginByCode()},sendCode:function(){api.showProgress({style:"default",animationType:"fade",title:"努力加载中...",text:"请稍候...",modal:!1}),api.ajax({url:website+"smscode.php",method:"post",timeout:30,data:{values:{ID:$api.getStorage("ID"),token:$api.getStorage("token"),tel:vm.tel,temp:3,templateSMS:"158243",systemType:api.systemType,systemVersion:api.systemVersion,deviceId:api.deviceId,deviceModel:api.deviceModel,deviceName:api.deviceName,operator:api.operator,connectionType:api.connectionType}},returnAll:!1},function(e,t){if(api.hideProgress(),e)if(1==e.succ){if(api.toast({msg:"发送成功",duration:2e3,location:"middle"}),vm.sending)return;vm.sending=!0,vm.time=vm.count;var i=setInterval(function(){if(0==vm.time)return clearInterval(i),void(vm.sending=!1);vm.time-=1},"1000")}else vm.sending=!1,api.toast({msg:"验证码发送失败",duration:2e3,location:"middle"});else tea.toast("ajax")})}},computed:{formatTime:function(){switch(this.time){case"获取验证码":return"获取验证码";case 0:return"重新发送";default:return this.time+"秒后重发"}},errorMsg:function(e){var t=new tea.checkRule;return"password"==this.type?t.add(this.password,[{condition:"minLength:6",errorMsg:"密码至少6位"}]):t.add(this.code,[{condition:"isCode",errorMsg:"请输入正确的验证码"}]),t.start()}}}),initModule(),initEventListener()}function initModule(){}function initEventListener(){}function getData(){}function blur(){for(var e=$api.domAll("input"),t=e.length-1;t>=0;t--)e[t].blur()}var dom={},vm=null;apiready=function(){init()}</script> </html>