<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{width:100%;height:100%}</style> </head> <body> <div id=app v-cloak> <div v-if=list.length class="aui-content aui-margin-b-15"> <ul class="aui-list aui-media-list aui-list-noborder"> <li v-for="(value,index) in list" v-if=value.telphone class="aui-list-item aui-list-item-middle" tapmode @click=openInfo(value.sID)> <div class=aui-media-list-item-inner> <div class=aui-list-item-media style=width:3rem> <img :src=value.img class=aui-list-img-sm> </div> <div class=aui-list-item-inner style=max-width:60%> <div class=aui-list-item-text> <div class="aui-list-item-title aui-font-size-14">{{ value.nickname }}</div> </div> <div class=aui-list-item-text v-if=value.telphone> <p class=aui-ellipsis-1>{{ value.msg ? value.msg : value.telphone.replace(/(\d{3})\d{5}(\d{3})/,'$1*****$2') }}</p> </div> </div> <div class=aui-list-item-media style=width:4rem> <div v-if="value.ok == 0　&& value.isfri == 0" class=aui-list-item-text> 等待通过 </div> <div v-else-if="value.ok == 0　&& value.isfri == 1" class="aui-btn aui-btn-info" style="padding:0 .5rem" tapmode @click.stop=accept(value,index)>通过</div> <div v-else class=aui-list-item-text> 已是好友 </div> </div> </div> </li> </ul> </div> <div v-else> <div class=aui-text-center style=margin-top:4rem> <p>您还没有新的好友</p> <div class="aui-btn aui-btn-info tea-btn-radius aui-margin-t-15" style="margin:0 auto" taomode onclick=share()> 邀请好友 </div> </div> </div> </div> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script src=../../script/share.js></script> <script type=text/template id=template> </script> <script>function init(){dom={},vm=new Vue({el:"#app",data:{list:[]},methods:{accept:function(e,t){acceptRequest(e.tempid,t)},openInfo:function(e){api.openWin({name:"user_info_win",url:"../location/user_info_win.html",pageParam:{friendID:e,pageType:"new_friends"},vScrollBarEnabled:!1})}},computed:{}}),getData(),initModule(),initEventListener()}function initModule(){}function initEventListener(){api.addEventListener({name:"reloaddate"},function(e,t){getData()}),api.addEventListener({name:"updataList"},function(e,t){getData()})}function getData(){tea.showp("刷新中...","请稍等...",!0),api.ajax({url:website+"friendship.php?action=gethf",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{ID:$api.getStorage("ID")}}},function(e,t){return api.hideProgress(),!!e&&(e?(vm.list=e,!0):void 0)})}function acceptRequest(e,t){tea.showp("发送请求中...","请稍等..."),api.ajax({url:website+"friendship.php?action=agrequest",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{ID:e}}},function(e,n){return api.hideProgress(),!!e&&("ok"==e.succ?(api.sendEvent({name:"reloaddate"}),api.sendEvent({name:"retxl"}),api.sendEvent({name:"updataDot"}),vm.list[t].ok=1,!0):void 0)})}var dom={},vm=null;apiready=function(){init()}</script> </html>