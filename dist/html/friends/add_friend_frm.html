<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title>title</title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto;background:0 0}</style> </head> <body> <div id=search class="aui-content aui-margin-b-15 aui-hide" tapmode onclick=addfriend()> <ul class="aui-list aui-media-list aui-list-noborder"> <li class="aui-list-item aui-list-item-middle"> <div class=aui-media-list-item-inner> <div class=aui-list-item-media style=width:3rem> <img src=../../image/carfriend_s.png class="aui-img-round aui-list-img-sm"> </div> <div class="aui-list-item-inner aui-list-item-arrow"> <div class=aui-list-item-text> <div class="aui-list-item-title aui-font-size-14">点击查找手机号/昵称</div> </div> <div id=value class="aui-list-item-text tea-text-blue"> www.auicss.com </div> </div> </div> </li> </ul> </div> </body> <script src=../../script/api.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script src=../../script/aui-toast.js></script> <script type=text/template id=template></script> <script>function initDOM(){dom.search=$api.byId("search"),dom.value=$api.byId("value"),dom.body=$api.dom("body")}function initVar(){values.value=""}function initHTML(){void 0!==api.pageParam.event&&"addFriend"==api.pageParam.event&&tea.toast("success")}function initEventListener(){api.addEventListener({name:"showSearch"},function(e,a){$api.addCls(dom.body,"tea-bg-default"),$api.removeCls(dom.search,"aui-hide"),values.value=e.value.str,dom.value.innerHTML=values.value})}function initModule(){}function getData(){}function updateDOM(){}function updateVar(){}function updateHTML(){}function sendEvent(){}function hide(){$api.removeCls(dom.body,"tea-bg-default"),$api.addCls(dom.search,"aui-hide"),values.value="",dom.value.innerHTML=""}function addfriend(){api.showProgress({style:"default",animationType:"fade",title:"数据查找中...",text:"请稍候...",modal:!0});var e=$api.getStorage("telphone"),a=gettoken(e),t=$api.getStorage("nickname"),i=values.value;return 0==i.length?(tea.toast("fail","不能输入空字符"),api.hideProgress(),!1):i==e||i==t?(tea.toast("fail","不能添加自己</br>到通讯录"),api.hideProgress(),!1):void api.ajax({url:website+"api.php?action=addfriend",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{token:a,frival:i}}},function(e,a){if(e){if(!e.errmsg){if("no"==e.succ)api.alert({msg:e.msg});else{$api.byId("seelogo");api.openWin({name:"详细资料",url:"./friendinfo_win.html",vScrollBarEnabled:!1,pageParam:{friid:e.friid,fritoken:e.fritoken}})}api.hideProgress()}}else api.hideProgress(),api.alert({msg:"错误码："+a.code+"；错误信息："+a.msg+"网络状态码："+a.statusCode})})}function sendaddfriendevnt(e){var a=$api.getStorage("telphone"),t=$api.getStorage("nickname"),i=gettoken(a);api.ajax({url:website+"friendship.php?action=sendfrimsg",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{token:i,fritoken:e,myname:t}}},function(e,a){e?e.errmsg||("no"==e.succ?api.alert({msg:e.msg}):(api.sendEvent({name:"reloaddate"}),api.closeWin())):api.alert({msg:"错误码："+a.code+"；错误信息："+a.msg+"网络状态码："+a.statusCode})})}function sendtitle(e){api.ajax({url:website+"jpush/push_message.php",method:"post",timeout:30,dataType:"text",returnAll:!1,data:{values:{users:e,content:"您有一个新的好友请求，点击查看",title:"您有一个好友请求"}}},function(e,a){})}function showmsg(e){var a=$api.byId("toptitle");$api.after(a,'<div id="errbox" style="text-align: center;background: #6e8aaf; width:50%; height:auto; margin:10px auto;">'+e+"</div>"),setTimeout("codefans()",2e3)}function codefans(){document.getElementById("errbox").style.display="none"}apiready=function(){initDOM(),initVar(),initHTML(),initEventListener(),initModule(),getData()};var dom={},data={},values={}</script> </html>