<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title>car-manage-add</title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto}.aui-list-item-right{max-width:60%!important;font-size:.8rem!important;color:#333!important}.aui-list-item-input{padding-right:0!important}.aui-list-item-input input{text-align:right}.aui-btn{width:66.6%;height:2.3rem;line-height:2.3rem;margin:2rem auto 1rem;border-radius:0}.clear-btn{display:-webkit-box;-webkit-box-pack:center;-webkit-box-align:center;width:1.1rem;height:1.1rem;background:#ededed;border-radius:50%;line-height:.6rem;text-align:center;float:left;color:#fff}.plate-img{margin:.75rem 0;width:3.75rem;height:2.5rem;display:inline-block}</style> </head> <body> <div class=aui-content> <ul class=aui-list> <li class=aui-list-item> <div class=aui-list-item-inner> <div class="aui-list-item-title tea-text-star-red">车牌号码</div> <div class=aui-list-item-right> <div class="aui-list-item aui-padded-l-0" style=justify-content:flex-end> <div class="aui-list-item-label aui-font-size-16" tapmode onclick=openWinPlateProvince() style=width:3rem> <span v-text=plateProvince id=plate-province class="tea-text-title tea-text-arrow-down">桂E</span> </div> <div class="aui-list-item-input aui-padded-r-0" style=width:45%> <input v-value=plateNum id=plate-num type=text placeholder=输入5位数 tapmode> </div> </div> </div> </div> </li> <li class=aui-list-item> <div class=aui-list-item-inner> <div class="aui-list-item-title tea-text-star-red">车型</div> <div class=aui-list-item-right> <span tapmode onclick=setCarType(1)> <span id=blue-radio class="aui-radio aui-margin-r-10" v-class-aui-checked=computedCartype(1)></span> <span>蓝牌</span> </span> <span tapmode onclick=setCarType(2)> <span id=yellow-radio class="aui-radio aui-margin-r-10 aui-margin-l-15" v-class-aui-checked=computedCartype(2)></span> <span>黄牌</span> </span> </div> </div> </li> <li class=aui-list-item> <div class=aui-list-item-inner> <div class="aui-list-item-title tea-text-star-red">行驶证所有人</div> <div class=aui-list-item-right> <div class=aui-list-item-input> <input id=real-name type=text placeholder=请输入姓名 tapmode v-value=realName> </div> </div> </div> </li> <li class=aui-list-item> <div class=aui-list-item-inner> <div class="aui-list-item-title tea-text-star-red">手机号码</div> <div class=aui-list-item-right> <div class=aui-list-item-input> <input id=tel class=aui-margin-r-10 type=text placeholder=请输入车主手机号码 tapmode v-value=tel required> </div> </div> </div> </li> <li class=aui-list-item tapmode onclick=openWinMedia()> <div class=aui-list-item-inner> <div class=aui-list-item-title>上传行驶证</div> <div class="aui-list-item-text aui-pull-right"> <span id=upload class=tea-text-blue v-unless=plateImg>上传</span> <span id=clear-btn class="clear-btn aui-margin-r-5 tea-big" tapmode onclick=clearImg(event) v-if=plateImg> <i class="aui-iconfont aui-icon-close"></i> </span> <img id=plate-img class=plate-img v-src=plateImg v-if=plateImg> </div> </div> </li> <li class=aui-list-item tapmode onclick=openWinPicker(0)> <div class=aui-list-item-inner> <div class=aui-list-item-title>审车到期时间</div> <div class=aui-list-item-right> <span v-text=checkRemindTime id=check-remind-time v-class-tea-text-blue=isRemind(0)>未填写</span> </div> </div> </li> <li class="aui-list-item aui-hide" v-unless=isRemind(0) tapmode onclick=setRemind(this)> <div class=aui-list-item-inner> <div class=aui-list-item-title>审车到期提醒</div> <div class=aui-list-item-right> <label id=check-remind class="aui-switch aui-checked"></label> </div> </div> </li> <li class=aui-list-item tapmode onclick=openWinPicker(1)> <div class=aui-list-item-inner> <div class=aui-list-item-title>保险到期时间</div> <div class=aui-list-item-right> <span v-text=insureRemindTime id=insure-remind-time v-class-tea-text-blue=isRemind(1)>未填写</span> </div> </div> </li> <li class="aui-list-item aui-hide" v-unless=isRemind(1) tapmode onclick=setRemind(this)> <div class=aui-list-item-inner> <div class=aui-list-item-title>保险到期提醒</div> <div class=aui-list-item-right> <label id=insure-remind class="aui-switch aui-checked"></label> </div> </div> </li> <li class=aui-list-item> <div class=aui-list-item-inner> <div class=aui-list-item-title></div> <div class=aui-list-item-right tapmode onclick=setVip()> <div id=vip-radio class="aui-radio aui-margin-r-10" v-class-aui-checked=vipRadio></div> <span class=tea-text-blue>加入VIP</span> </div> </div> </li> </ul> </div> <footer> <div id=save-btn class="aui-btn aui-btn-block tea-bg-light-blue aui-text-white" v-class-tea-active=saveBtn() tapmode onclick=submit()>确认保存</div> </footer> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script type=text/template id=template> </script> <script>function initVar(){dom=$api.domAll("[v-value],[v-if],[v-text],[v-src],[v-class-aui-checked],[v-class-tea-active],[v-unless]"),data={},values={ID:$api.getStorage("ID"),plateProvince:"桂E",plateNum:"",cartype:1,realName:$api.getStorage("nickname"),tel:$api.getStorage("telphone"),plateImg:null,insureRemindTime:"未填写",checkRemindTime:"未填写",insureRemind:!1,checkRemind:!1,vipRadio:!1,saveBtn:function(){return!check()},computedCartype:function(e){return this.cartype==e},isRemind:function(e){return 0==e?"未填写"==this.checkRemindTime:1==e?"未填写"==this.insureRemindTime:void 0}},updateHTML()}function initModule(){}function initEventListener(){api.addEventListener({name:"selectPlateProvince"},function(e,a){e&&vm.set("plateProvince",e.value.province+e.value.city)}),api.addEventListener({name:"sendImg"},function(e,a){if(e){if("car_manage_add_frm"!=e.value.to)return;api.closeWin({name:"media_win"}),vm.set("plateImg",e.value.img[0])}else alert(JSON.stringify(a))}),api.addEventListener({name:"pickerSure"},function(e,a){if(e){var i=e.value.option.join("-");0==e.value.index&&vm.set("checkRemindTime",i),1==e.value.index&&vm.set("insureRemindTime",i)}else alert(JSON.stringify(a))})}function getData(){}function updateVar(){}function updateDom(){}function updateHTML(){}function openWinPlateProvince(){event.stopPropagation(),api.openWin({name:"plateProvince",url:"../car_plate/plate_province_win.html",pageParam:{name:"test"}})}function openWinMedia(){api.openWin({name:"media_win",url:"../unit/media_win.html",pageParam:{to:"car_manage_add_frm",type:"picture",limit:1}})}function openWinPicker(e){var a=(new Date).getFullYear(),i=a+1,t=a+7;api.openFrame({name:"picker_frm",url:"../unit/picker_frm.html",pageParam:{index:e,height:225,rows:5,option:[i,1,1],options:[{tag:"年",scope:i+"-"+t},{tag:"月",scope:"1-12"},{tag:"日",scope:"1-31"}]}})}function clearImg(e){e.stopPropagation(),vm.set("plateImg","")}function setCarType(e){vm.set("cartype",e)}function setVip(){vm.set("vipRadio",!values.vipRadio)}function setRemind(e){var a=$api.dom(e,".aui-switch");tea.toggle(a,"aui-checked")}function submit(){var e=check();if(e)return tea.toast("fail",e),!1;api.showProgress({style:"default",animationType:"fade",title:"提交数据中...",text:"请稍候...",modal:!0}),values.plateImg?tea.imgCompress(values.plateImg,.8,.8,upload):post()}function check(){var e=new tea.checkRule;return e.add(values.plateNum,[{condition:"isNoEmpty",errorMsg:"请输入车牌号码"}]),e.add(values.realName,[{condition:"isNoEmpty",errorMsg:"请输入车主姓名"}]),e.add(values.tel,[{condition:"isPhone",errorMsg:"请输入格式正确</br>的手机号码"}]),e.start()}function upload(e){uploadImg(website+"upxs.php",e,post)}function uploadImg(e,a,i){var t={userid:values.userid};api.ajax({url:e,method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:t,files:{upfile:a}}},function(e,a){e&&(1==e.statu?i(e.path):0==e.statu&&alert("上传失败"))})}function post(e){var a=$api.byId("check-remind"),i=$api.byId("insure-remind"),t=$api.hasCls(a,"aui-checked")?0:30,n=$api.hasCls(i,"aui-checked")?0:30,r={ID:$api.getStorage("ID"),ntime:values.checkRemindTime,btime:values.insureRemindTime,sctips:t,bxtips:n,cpm:values.plateProvince+values.plateNum,xszr:values.realName,cartype:values.cartype,xszimg:e,tel:values.tel};api.ajax({url:website+"?action=addcar",method:"post",data:{values:r}},function(e,a){api.hideProgress(),e?(api.sendEvent({name:"carManageInfoChange"}),tea.toast("success","提交成功"),values.vipRadio?api.openWin({name:"vip_join_win",url:"../vip/vip_join_win.html",pageParam:{carid:e.carid}}):api.closeWin()):alert(JSON.stringify(a))})}var dom={},data={},values={};apiready=function(){initVar(),initModule(),initEventListener(),getData(),vm.scan(),vm.addEventListener()}</script> </html>