<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <title></title> <link rel=stylesheet type=text/css href=../../css/aui_old.css /> <link rel=stylesheet type=text/css href=../../css/common.css /> </head> <style type=text/css></style> <body> <p class="aui-padded-10 aui-text-center">设置审车到期提醒</p> <div class="aui-content aui-card"> <div class=aui-form> <div class=aui-input-row> <span class=aui-input-addon>年审到期时间</span> <input type=text class=aui-input placeholder=点击选择年审到期时间 id=ntime onclick='selecttime("ntime")' readonly=readonly /> </div> <div class=aui-input-row> <span class=aui-input-addon>年审差不多到期时自动通知</span> <input type=checkbox class="aui-switch aui-pull-right" id=ck1 onclick=getck(1) checked=checked> </div> <div class=aui-content id=rd1> </div> </div> </div> <p class="aui-padded-10 aui-text-center">设置保险到期提醒</p> <div class="aui-content aui-card"> <div class=aui-form> <div class=aui-input-row> <span class=aui-input-addon>保险到期时间</span> <input type=text class=aui-input placeholder=点击选择保险到期时间 id=btime onclick='selecttime("btime")' readonly=readonly /> </div> <div class=aui-input-row> <span class=aui-input-addon>保险差不多到期时自动通知</span> <input type=checkbox class="aui-switch aui-pull-right" id=ck2 onclick=getck(2) checked=checked> </div> <div class=aui-content id=rd2> </div> </div> </div> </body> <script src=../../script/api.js></script> <script src=../../script/conn.js></script> <script>function getck(a){if($api.byId("ck"+a).checked)$api.html($api.byId("rd"+a),sethtml(a));else{var e=$api.byId("rdo"+a);$api.remove(e)}}function sethtml(a){var e="";return e+='<div class="aui-form" id="rdo'+a+'">',e+='<div class="aui-input-row">',e+='<label class="aui-input-addon">提前三天每天通知</label>',e+='<input class="aui-pull-right aui-radio" type="radio" name="rad'+a+'" value="3" checked>',e+="</div>",e+='<div class="aui-input-row">',e+='<label class="aui-input-addon">提前一周每天通知</label>',e+='<input class="aui-pull-right aui-radio" type="radio" name="rad'+a+'" value="7">',e+="</div>",e+='<div class="aui-input-row">',e+='<label class="aui-input-addon">提前一个月每天通知</label>',e+='<input class="aui-pull-right aui-radio" type="radio" name="rad'+a+'" value="30">',e+="</div>",e+="</div>"}function edithtml(a){var e="";return e+='<div class="aui-form" id="rdo'+a+'">',e+='<div class="aui-input-row">',e+='<label class="aui-input-addon">提前三天每天通知</label>',e+='<input class="aui-pull-right aui-radio" type="radio" id="r'+a+'3" name="rad'+a+'" value="3">',e+="</div>",e+='<div class="aui-input-row">',e+='<label class="aui-input-addon">提前一周每天通知</label>',e+='<input class="aui-pull-right aui-radio" type="radio" id="r'+a+'7" name="rad'+a+'" value="7">',e+="</div>",e+='<div class="aui-input-row">',e+='<label class="aui-input-addon">提前一个月每天通知</label>',e+='<input class="aui-pull-right aui-radio" type="radio" id="r'+a+'30" name="rad'+a+'" value="30">',e+="</div>",e+="</div>"}function loaddate(){showp("数据加载中...","请稍候..."),api.ajax({url:website+"getmycar.php?action=carinfo",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{ID:api.pageParam.id}}},function(a,e){a?a.errmsg||($api.val($api.byId("ntime"),a.scextime),$api.val($api.byId("btime"),a.bxextime),"0"==a._scremind?$api.removeAttr($api.byId("ck1"),"checked"):($api.html($api.byId("rd1"),edithtml(1)),$api.attr($api.byId("r1"+a._scremind),"checked","checked")),"0"==a._bxremind?$api.removeAttr($api.byId("ck2"),"checked"):($api.html($api.byId("rd2"),edithtml(2)),$api.attr($api.byId("r2"+a._bxremind),"checked","checked")),api.hideProgress()):(api.hideProgress(),api.alert({msg:"错误码："+e.code+"；错误信息："+e.msg+"网络状态码："+e.statusCode}))})}function getradselect(a){var e=document.getElementsByName("rad"+a);for(i=0;i<e.length;i++)if(e[i].checked)return e[i].value}function selecttime(a){"ntime"==a?api.openFrame({name:"selecttime",url:"selecttime_frm.html",pageParam:{pagetype:a},rect:{x:0,y:320,w:api.frameWidth,h:api.winHeight-320},bounces:!1,bgColor:"rgba(0,0,0,0)",vScrollBarEnabled:!1,hScrollBarEnabled:!1}):api.openFrame({name:"selecttime",url:"selecttime_frm.html",pageParam:{pagetype:a},rect:{x:0,y:0,w:api.frameWidth,h:api.winHeight-300},bounces:!1,bgColor:"rgba(0,0,0,0)",vScrollBarEnabled:!1,hScrollBarEnabled:!1})}function postdate(){if("edit"==api.pageParam.type)var a="editcar",e=api.pageParam.id;else var a="addcar",e=$api.getStorage("ID");var i=""==$api.val($api.byId("ck1"))?"0":getradselect(1),t=""==$api.val($api.byId("ck2"))?"0":getradselect(2),r=$api.val($api.byId("ntime")),d=$api.val($api.byId("btime")),p=$api.getStorage("cpm"),l=$api.getStorage("xszr"),s=$api.getStorage("ckr"),o=$api.getStorage("ckrs"),n=$api.getStorage("cartype"),c=$api.getStorage("xsz_img");if(""==r||""==d)return api.toast({msg:"时间没有选择，请选择时间"}),!1;showp("数据提交中...","请稍候..."),api.ajax({url:website+"?action="+a,method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{ID:e,ntime:r,btime:d,sctips:i,bxtips:t,cpm:p,xszr:l,ckr:s,ckrs:o,cartype:n,xszimg:c}}},function(a,e){if(a){var i=JSON.stringify(a);console.log(i),"ok"==a.succ?($api.rmStorage("cpm"),$api.rmStorage("xszr"),$api.rmStorage("ckr"),$api.rmStorage("ckrs"),$api.rmStorage("cartype"),$api.rmStorage("xsz_img"),api.sendEvent({name:"saveok"}),api.closeToWin({name:"mycar_win"}),api.hideProgress()):(api.alert({msg:a.ermsg}),api.hideProgress())}else api.hideProgress(),api.alert({msg:"错误码："+e.code+"；错误信息："+e.msg+"网络状态码："+e.statusCode})})}function showjd(){api.showProgress({style:"default",animationType:"fade",title:"图片处理中...",text:"请稍候...",modal:!1})}apiready=function(){api.parseTapmode(),api.addEventListener({name:"postdate"},function(a,e){postdate()}),api.addEventListener({name:"selecttime"},function(a,e){var i=$api.byId(a.value.pagetype),t=a.value.time1+"-"+a.value.time2+"-"+a.value.time3;$api.val(i,t)}),"edit"==api.pageParam.type?loaddate():($api.html($api.byId("rd1"),sethtml(1)),$api.html($api.byId("rd2"),sethtml(2)))}</script> </html>