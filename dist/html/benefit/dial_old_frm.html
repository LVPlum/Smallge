<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="teletel=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto;background:0 0}.tea-dial-circle{width:15.8rem;height:18.25rem;background-image:url(../../image/benefit/benefit_dial_circle@2x.png);background-size:100% 100%;background-repeat:no-repeat;position:relative;margin:0 auto}.tea-dial-award,.tea-dial-start{background-size:100%;position:absolute;top:50%;left:50%}.tea-dial-award{width:14rem;height:14rem;z-index:-1;margin-left:-7rem;margin-top:-7rem;background-repeat:no-repeat}.tea-dial-start{width:4.95rem;height:5.72rem;background-image:url(../../image/benefit/benefit_dial_start@2x.png);margin-left:-2.47rem;margin-top:-2.86rem;background-repeat:no-repeat}.success{background:#ffaa4e;width:75%;height:2rem;margin:0 auto;line-height:2rem;border-radius:30px;box-shadow:2px 2px 1px 0 #ff603a}.hide{opacity:0}.closeBtn{position:absolute;right:10%;z-index:999}</style> </head> <body class=tea-body-mask tapmode ontouchend='tea.closeFrame(event,"dial")'> <div class=aui-padded-b-10 style=overflow:hidden;width:100% id=dial> <div class=closeBtn tapmode onclick=closeFrm()><i class="aui-iconfont aui-icon-close tea-font-weight-bold aui-text-white"></i></div> <div class=tea-dial-circle> <div id=rotate class=tea-dial-award><img src=../../image/benefit/benefit_dial_award@2x.png></div> <div class=tea-dial-start tapmode onclick=dialStart()></div> </div> <div class="success hide" id=result tapmode onclick=closeFrm()> <div class="aui-font-size-16 tea-text-title"> <span id=msg class=aui-font-size-14 style=color:#41271e;font-weight:700>恭喜获得￥10元审车现金券</span> </div> </div> </div> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script type=text/template id=template> </script> <script src=../../script/aui-dialog.js></script> <script>function initVar(){dom={},data={mask:!0,deg:0,award_name:""},values={},updateHTML()}function initModule(){}function initEventListener(){}function getData(){}function updateVar(){}function updateDom(){}function updateHTML(){}function dialStart(){data.mask&&data.mask&&(showp(""),data.mask=!1,api.ajax({url:website+"api_cj.php?action=get_lottery_item",method:"post",data:{values:{lottery_item:"2",ID:$api.getStorage("ID")}}},function(a,t){return api.hideProgress(),a?1==a.ok?(getLotteryResult(),!0):(api.toast({msg:a.msg,duration:2e3,location:"middle"}),void(data.mask=!0)):(tea.toast("ajax"),data.mask=!0,!1)}))}function getLotteryResult(){showp(""),api.ajax({url:website+"api_cj.php?action=draw",method:"post",timeout:30,data:{values:{lottery_item:"2",userid:$api.getStorage("ID"),token:$api.getStorage("token"),deviceId:api.deviceId,nickname:$api.getStorage("nickname")}}},function(a,t){return api.hideProgress(),a?1==a.succ?(whichAward(a.lottery_id),document.getElementById("rotate").addEventListener("webkitTransitionEnd",function(){if(8!=a.lottery_id)lotteryPop(t="恭喜获得"+a.lottery_open+"~");else{var t="很遗憾未中奖~明天再来哦！";lotteryPop(t)}api.sendEvent({name:"lotteryOK"}),data.mask=!0}),!0):(api.toast({msg:a.msg,duration:2e3,location:"middle"}),void(data.mask=!0)):(tea.toast("ajax"),data.mask=!0,!1)})}function whichAward(a){switch(data.deg=Math.floor(20*Math.random()+10),a){case 1:data.deg+=135,data.award_name="10积分";break;case 2:data.deg+=45,data.award_name="20积分";break;case 3:data.deg+=225,data.award_name="30积分";break;case 4:data.deg+=90,data.award_name="审车现金券 ￥10";break;case 5:data.deg+=0,data.award_name="汽车保险现金券 ￥20";break;case 6:data.deg+=270,data.award_name="审车现金券 ￥5";break;case 7:data.deg+=180,data.award_name="特权卡现金券 ￥50";break;case 8:data.deg+=315,data.award_name="谢谢参与"}rotateEle("rotate",data.deg)}function rotateEle(a,t){var e=document.getElementById(a);data.deg+=1800,e.style.cssText="transition:all 5s;transform:rotate("+data.deg+"deg)"}function lotteryPop(a){var t=$api.byId("result"),e=$api.byId("msg");$api.removeCls(t,"hide"),$api.text(e,a)}function closeFrm(){api.closeFrame()}var dom={},data={},values={};apiready=function(){initVar(),initModule(),initEventListener(),getData()}</script> </html>