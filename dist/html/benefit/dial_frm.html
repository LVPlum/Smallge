<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="teletel=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto;background:0 0}.tea-dial-circle{width:15.8rem;height:18.25rem;background-image:url(../../image/benefit/benefit_dial_circle@2x.png);background-size:100% 100%;background-repeat:no-repeat;position:relative;margin:0 auto}.tea-dial-award,.tea-dial-start{background-size:100%;position:absolute;top:50%;left:50%}.tea-dial-award{width:14rem;height:14rem;z-index:-1;margin-left:-7rem;margin-top:-7rem;background-repeat:no-repeat}.tea-dial-start{width:4.95rem;height:5.72rem;background-image:url(../../image/benefit/benefit_dial_start@2x.png);margin-left:-2.47rem;margin-top:-2.86rem;background-repeat:no-repeat}.success{background:#ffaa4e;width:75%;height:2rem;margin:0 auto;line-height:2rem;border-radius:30px;box-shadow:2px 2px 1px 0 #ff603a;position:absolute;left:12.5%}.hide{opacity:0}.closeBtn{position:absolute;right:10%;z-index:999}</style> </head> <body class=tea-body-mask tapmode ontouchend='tea.closeFrame(event,"app")'> <div id=app v-cloak class=aui-padded-b-10 style=overflow:hidden;width:100%> <div class=closeBtn tapmode @click=closeFrm><i class="aui-iconfont aui-icon-close tea-font-weight-bold aui-text-white"></i></div> <div class=tea-dial-circle> <div id=rotate class=tea-dial-award> <img :src="award ? award : '../../image/benefit/benefit_dial_award@2x.png' "> </div> <div class=tea-dial-start tapmode @click=dialStart></div> </div> <div v-show=result class=success id=result tapmode @click=closeFrm> <div class="aui-font-size-16 tea-text-title"> <span id=msg class=aui-font-size-14 style=color:#41271e;font-weight:700>{{ result }}</span> </div> </div> </div> <script type="text/javascript" src="../../html/benefit/dial_frm.js"></script></body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script type=text/template id=template> </script> <script src=../../script/aui-dialog.js></script> <script>function initVar(){dom={},data={deg:0,award_name:""},values={},vm=new Vue({el:"#app",data:{mask:!0,result:"",award:""},methods:{dialStart:function(){vm.mask&&(vm.mask=!1,getResult())},closeFrm:function(){api.closeFrame()}},computed:{}}),getDial(),updateHTML()}function initModule(){}function initEventListener(){}function getData(){}function updateVar(){}function updateDom(){}function updateHTML(){}function getDial(){tea.showp("加载中"),api.ajax({url:website+"api_cj.php?action=get_lottery_item",method:"post",timeout:30,data:{values:{lottery_item:"7",ID:$api.getStorage("ID")}}},function(t,a){if(api.hideProgress(),!t)return tea.toast("ajax"),!1;1==t.ok&&(vm.award=t.lottery_img)})}function getResult(){tea.showp("加载中"),api.ajax({url:website+"api_cj.php?action=draw",method:"post",timeout:30,data:{values:{lottery_item:"7",userid:$api.getStorage("ID"),token:$api.getStorage("token"),deviceId:api.deviceId,nickname:$api.getStorage("nickname")}}},function(t,a){return api.hideProgress(),t?1==t.succ?(whichAward(t.lottery_id),document.getElementById("rotate").addEventListener("webkitTransitionEnd",function(){8!=t.lottery_id?vm.result="恭喜获得"+t.lottery_open+"~":vm.result="很遗憾未中奖~明天再来哦！",api.sendEvent({name:"lotteryOK"}),vm.mask=!0}),!0):(api.toast({msg:t.msg,duration:2e3,location:"middle"}),vm.mask=!0,!1):(tea.toast("ajax"),vm.mask=!0,!1)})}function whichAward(t){switch(data.deg=Math.floor(20*Math.random()+10),t){case 1:data.deg+=0;break;case 2:data.deg+=45;break;case 3:data.deg+=90;break;case 4:data.deg+=135;break;case 5:data.deg+=180;break;case 6:data.deg+=225;break;case 7:data.deg+=270;break;case 8:data.deg+=315}rotateEle("rotate",data.deg)}function rotateEle(t,a){var e=document.getElementById(t);data.deg+=1800,e.style.cssText="transition:all 5s;transform:rotate("+data.deg+"deg)"}var dom={},data={},values={},vm=null;apiready=function(){initVar(),initModule(),initEventListener(),getData()}</script> </html>