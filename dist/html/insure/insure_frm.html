<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title>title</title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto}</style> </head> <body> <section class="aui-content-padded aui-margin-b-10 tea-bg-white tea-content-radius-10"> <ul id=plate class="aui-list aui-list-in aui-form-list aui-list-noborder"> <li class=aui-list-item> <div class=aui-list-item-inner> <div class=aui-list-item-label tapmode onclick=openWinPlateProvince() style=width:4rem> <span id=plate-province class="tea-text-title tea-text-star-red tea-text-arrow-down">桂E</span> </div> <div class=aui-list-item-input> <input id=plate-num type=text placeholder=请输入车牌后5位数 tapmode oninput=changePlateNum(this)> </div> <div id=select class="tea-text-round tea-big aui-hide" tapmode onclick=openWinPlateNum()>选</div> </div> </li> </ul> <ul id=new-car class="aui-list aui-list-in aui-list-noborder" tapmode onclick=toggleLicense(this)> <li class=aui-list-item> <div class=aui-list-item-inner> <div class="aui-list-item-title tea-text-default">新车（暂无牌照）</div> <div class=aui-list-item-right> <label class=aui-radio></label> </div> </div> </li> </ul> </section> <section class="aui-content-padded aui-margin-b-10 tea-bg-white tea-content-radius-10"> <ul class="aui-list aui-media-list aui-list-noborder"> <li class=aui-list-item> <div class=aui-list-item-inner> <div class="aui-list-item-title aui-margin-b-10">请选其一</div> <div class=aui-row> <div class="aui-col-xs-6 tea-text-blue tea-big tea-big-height" tapmode onclick=openFrameInsureInput()> <i class="aui-iconfont aui-icon-pencil"></i> 手动输入 </div> <div class="aui-col-xs-6 tea-text-blue tea-big tea-big-height" tapmode onclick=openFrameInsurePhoto()> <i class="aui-iconfont aui-icon-camera"></i> 拍照上传 </div> </div> </div> </li> </ul> </section> </body> <script src=../../script/api.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script type=text/template id=template></script> <script>function initDOM(){plateNum=$api.byId("plate-num"),plateProvince=$api.byId("plate-province"),select=$api.byId("select")}function initVar(){values.lisence=!0,values.plate="桂E"}function initHTML(){}function initEventListener(){api.addEventListener({name:"addOldCar"},function(e,a){e&&(values.plate=e.value.car,values.telphone=e.value.tel,updatePlate())}),api.addEventListener({name:"selectPlateProvince"},function(e,a){if(e){var t=e.value.province+e.value.city;values.plate=t+values.plate.slice(2),updatePlate()}})}function initModule(){}function getData(){api.showProgress({style:"default",animationType:"fade",title:"努力加载中...",text:"先喝杯茶...",modal:!0});var e=$api.getStorage("ID");api.ajax({url:website+"getmycar.php?action=getmycar",method:"post",data:{values:{ID:e}}},function(e,a){api.hideProgress(),e?(updateVar(e),updatePlate(),$api.removeCls(select,"aui-hide")):$api.addCls(select,"aui-hide")})}function updateDOM(){}function updateVar(e){data.mycar=e;var a=data.mycar.length-1;values.plate=data.mycar[a].carnum,void 0!==(order=api.pageParam.order)&&updateOrder()}function updateOrder(){""==order.carnum&&(values.lisence=!1),values.plate=order.carnum}function updateHTML(){}function updatePlate(){plateProvince.innerHTML=values.plate.slice(0,2),$api.val(plateNum,values.plate.slice(2)),values.lisence||toggleLicense($api.byId("new-car"))}function sendEvent(){}function closeWin(){api.closeWin()}function openFrameInsureInput(){test()&&api.openFrame({name:"insure_input_frm",url:"./insure_input_frm.html",pageParam:{values:values,order:order},bounces:!1,bgColor:"rgba(0,0,0,0.6)",vScrollBarEnabled:!0,hScrollBarEnabled:!0})}function openFrameInsurePhoto(){test()&&api.openFrame({name:"insure_photo_frm",url:"./insure_photo_frm.html",pageParam:{values:values,order:order},bounces:!1,bgColor:"rgba(0,0,0,0.6)",vScrollBarEnabled:!0,hScrollBarEnabled:!0})}function openWinPlateProvince(){event.stopPropagation(),api.openWin({name:"plateProvince",url:"../car_plate/plate_province_win.html",pageParam:{name:"test"}})}function openWinPlateNum(){api.openWin({name:"plateNum",url:"../car_plate/plate_num_win.html",pageParam:{name:"test"}})}function toggleLicense(e){var a=$api.dom(e,".aui-radio");tea.toggle("plate"),tea.toggle(a,"aui-checked")?(values.lisence=!1,api.execScript({frameName:"insure_photo_frm",script:"values.lisence = false;initHTML();"})):(values.lisence=!0,api.execScript({frameName:"insure_photo_frm",script:"values.lisence = true;initHTML();"}))}function changePlateNum(e){event.stopPropagation(),values.plateNum=$api.val(e),values.plate=values.plate.slice(0,2)+values.plateNum}function test(){if(!1!==values.lisence){if(""===values.plateProvince)return api.toast({msg:"请选择车牌归属地~",duration:2e3,location:"middle"}),!1;if(values.plate.length<3)return api.toast({msg:"请输入格式正确的车牌号码~",duration:2e3,location:"middle"}),!1}return!0}apiready=function(){initDOM(),initVar(),initHTML(),initEventListener(),initModule(),getData()};var dom={},data={},values={},order</script> </html>