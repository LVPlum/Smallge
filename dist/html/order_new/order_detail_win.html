<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{width:100%;height:100%}</style> </head> <body> <div id=app> <header id=header class="aui-bar aui-bar-nav aui-bar-light"> <a class="aui-btn aui-pull-left" tapmode onclick=closeWin()> <span class="aui-iconfont aui-icon-left tea-text-title"></span> </a> <div class="aui-title tea-text-title">订单详情</div> </header> <section id=main></section> <footer v-if=isShow class="aui-bar aui-bar-tab" id=footer @click=closeFrm> <div class="aui-bar-tab-item aui-border-r tea-text-default" style=width:50% @click.stop=openFrmOrderFee()> <span class=aui-font-size-12>总计</span> <span id=down-price class="aui-margin-r-5 tea-text-red">¥{{tea.formatMoney(orderPrice) || 0}}</span> <span v-if="type == 'insure'" class="aui-font-size-12 tea-text-arrow-down">明细</span> </div> <div class="aui-bar-tab-item tea-bg-orange aui-text-white" tapmode @click.stop=openWinPay() style=width:50%> 立即支付 </div> </footer> </div> </body> <script src=../../script/api.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script src=../../script/fastclick.min.js></script> <script src=../../script/tea.js></script> <script type=text/template id=template></script> <script>function init(){header=$api.byId("header"),$api.fixStatusBar(header),headerH=$api.offset(header).h,footer=$api.byId("footer"),footerH=footer?$api.offset(footer).h:0,initModule(),initEventListener()}function initModule(){}function initEventListener(){api.addEventListener({name:"updateOrderFee"},function(e,r){vm.fee=e.value;var a=vm.fee;a.billBenefit=parseFloat(a.needpay)+parseFloat(a.travelFee)-parseFloat(a.orderFee)}),api.setFrameClient({frameName:"order_fee_frm"},function(e,r){2==e.state&&(vm.frm=!0)})}function getData(){}function closeWin(){api.closeWin()}function openFrame(){var e=api.winName.replace("win","frm");api.openFrame({name:e,url:"./"+e+".html",rect:{x:0,y:headerH,w:"auto",h:api.winHeight-headerH-footerH},pageParam:api.pageParam,bounces:!1})}var header,footer,headerH,footerH,vm;apiready=function(){var e=api.pageParam;e.fee={},e.frm=!1,vm=new Vue({el:"#app",data:e,methods:{openWinPay:function(){api.sendEvent({name:"orderPost",extra:{orderPrice:vm.orderPrice}})},toPay:function(){alert("请到线下门店付款")},openFrmOrderFee:function(){if(this.frm)return!1;api.openFrame({name:"order_fee_frm",url:"./order_fee_frm.html",rect:{x:0,y:0,w:"auto",h:api.winHeight-footerH},pageParam:vm.fee,bounces:!1,bgColor:"rgba(0,0,0,0.6)",vScrollBarEnabled:!0,hScrollBarEnabled:!0})},closeFrm:function(){this.frm&&(api.closeFrame({name:"order_fee_frm"}),this.frm=!1)}},computed:{isShow:function(){return"insure"==this.type&&2==this.status&&1==this.insureCheck||"vip"==this.type&&2==this.status},orderPrice:function(){var e=this.fee;return e.orderFee?parseFloat(e.orderFee)+parseFloat(e.postFee)-parseFloat(e.couponFee):this.money}},watch:{}}),init(),openFrame()}</script> </html> 