<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title>title</title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{width:100%;height:100%;overflow:auto}.aui-searchbar{background-color:#fff;height:2.25rem}</style> </head> <body> <header id=header class="aui-bar aui-bar-nav aui-bar-light"> <a class="aui-btn aui-pull-left" tapmode onclick=closeWin()> <span class="aui-iconfont aui-icon-left tea-text-title"></span> </a> <div class="aui-title tea-text-title">选择代办机构</div> </header> <section id=main></section> <footer id=footer></footer> </body> <script src=../../script/api.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script>function initDOM(){}function initVar(){data=api.pageParam.data}function getData(){updateVar(),updateHTML()}function updateDOM(){}function updateVar(){}function updateHTML(){}function initEventListener(){}function init(){var t=document.querySelector(".aui-searchbar"),a=document.querySelector(".aui-searchbar input"),e=document.querySelector(".aui-searchbar .aui-searchbar-btn"),n=document.querySelector(".aui-searchbar .aui-searchbar-clear-btn");t&&(a.onclick=function(){e.style.marginRight=0},a.oninput=function(){this.value.length?(n.style.display="block",e.classList.add("aui-text-info"),e.textContent="搜索"):(n.style.display="none",e.classList.remove("aui-text-info"),e.textContent="取消")}),n.onclick=function(){this.style.display="none",a.value="",e.classList.remove("aui-text-info"),e.textContent="取消"},e.onclick=function(){var t=a.value;t.length?(a.blur(),document.getElementById("search-keywords").textContent=t):(this.style.marginRight="-"+this.offsetWidth+"px",a.value="",a.blur())}}function initBmap(){function t(){bMap.getLocation({accuracy:"100m",autoStop:!0,filter:1},function(t,a){t.status?getDistance(area=t):(api.toast({msg:"定位未成功",duration:2e3,location:"middle"}),openFrame())})}bMap=api.require("bMap"),"ios"==api.systemType?bMap.initMapSDK(function(a){a.status?t():openFrame()}):t()}function getDistance(t){bMap.getDistance({start:{lon:t.lon,lat:t.lat},end:{lon:data[flag].longitude,lat:data[flag].latitude}},function(t){t.status&&(data[flag].distance=t.distance),++flag>=data.length?openFrame():getDistance(area)})}function addEvent(){}function closeWin(){api.closeWin()}function openFrame(){api.openFrame({name:"agencies_frm",url:"./agencies_frm.html",rect:{x:0,y:headerH,w:"auto",h:api.winHeight-headerH-footerH},pageParam:api.pageParam,bgColor:"#f2f5f8",bounces:!1,allowEdit:!0})}var header,footer,headerH,footerH,data={},bMap,flag=0,area={};apiready=function(){header=$api.byId("header"),$api.fixStatusBar(header),headerH=$api.offset(header).h,footer=$api.byId("footer"),footerH=$api.offset(footer).h,initDOM(),initVar(),getData(),initEventListener(),initBmap()}</script> </html>