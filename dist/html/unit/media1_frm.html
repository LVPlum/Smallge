<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title>title</title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{overflow:auto;background-color:#f2f5f8}.img-box{position:relative;height:0;margin:0;padding-bottom:100%;overflow:hidden;background-color:#fff;background-position:center;background-repeat:no-repeat;background-size:cover}</style> </head> <body> <div class="aui-content aui-margin-b-15"> <ul class="aui-list aui-media-list aui-list-noborder"> <li class="aui-list-item tea-bg-default"> <div class=aui-list-item-inner> <div class="aui-row aui-row-padded" id=list> <div class="aui-col-xs-4 aui-text-center camera" tapmode onclick=usercamera()> <i class="aui-iconfont aui-icon-camera" style=font-size:35px></i> <p>使用相机</p> </div> </div> </div> </li> </ul> </div> </body> <script src=../../script/api.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script type=text/template id=template></script> <script>function initDOM(){}function initVar(){limit=api.pageParam.limit,imgId=api.pageParam.imgId,isIOS="ios"==api.systemType,UIMediaScanner=api.require("UIMediaScanner"),imageBrowser=api.require("imageBrowser")}function initHTML(){showp("相册准备中",""),UIMediaScanner.scan({type:"picture",count:30,sort:{key:"time",order:"desc"},thumbnail:{w:800,h:800}},function(i){if(i){for(var e=$api.byId("list"),a="",t=0,n=i.list.length;t<n;t++){var o=i.list[t];a+='<div class="aui-col-xs-4">',a+=1==limit?'<div class="img-box" style="background-image:url('+o.thumbPath+')" tapmode onclick="sendimg(\''+o.path+"')\"></div>":'<img src="'+o.thumbPath+'" tapmode onclick="openbigimg(\''+o.path+'\')"><input type="checkbox" date-img="'+o.path+'" class="aui-checkbox chbox" tapmode="" name="checkbox" onclick="checksel()">',a+="</div>"}$api.append(e,a),api.hideProgress()}})}function initEventListener(){api.addEventListener({name:"scrolltobottom",extra:{threshold:0}},function(i,e){updateHTML()})}function initModule(){}function getData(){}function updateDOM(){}function updateVar(){}function updateHTML(){api.showProgress({style:"default",animationType:"fade",title:"图片加载中...",text:"",modal:!1}),UIMediaScanner.fetch(function(i,e){if(i){for(var a=$api.byId("list"),t="",n=0,o=i.list.length;n<o;n++){var c=i.list[n];t+='<div class="aui-col-xs-4">',t+=1==limit?'<div class="img-box" style="background-image:url('+c.thumbPath+')" tapmode onclick="sendimg(\''+c.path+"')\"></div>":'<img src="'+c.thumbPath+'" tapmode onclick="openbigimg(\''+c.path+'\')"><input type="checkbox" date-img="'+c.path+'" class="aui-checkbox chbox" tapmode="" name="checkbox" onclick="checksel()">',t+="</div>"}$api.append(a,t)}else api.toast({msg:"没有更多图片了"});api.hideProgress()})}function sendEvent(){}function sendimg(i,e){api.showProgress({style:"default",animationType:"fade",title:"图片加载中...",text:"",modal:!1}),isIOS&&void 0===e?UIMediaScanner.transPath({path:i},function(i,e){if(i){var a=i.path;api.sendEvent({name:"getimgarr",extra:{img:a,imgId:imgId}}),api.closeWin(),api.hideProgress()}}):(api.sendEvent({name:"getimgarr",extra:{img:i,imgId:imgId}}),api.closeWin(),api.hideProgress())}function usercamera(){api.getPicture({sourceType:"camera",encodingType:"jpg",destinationType:"url",mediaValue:"pic",quality:100,saveToPhotoAlbum:!0},function(i,e){i&&i.data?sendimg(i.data,1):api.toast({msg:"没有选择，或者选择出错"})})}apiready=function(){initDOM(),initVar(),initHTML(),initEventListener(),initModule(),getData()};var dom={},data={},values={},UIMediaScanner=null,imageBrowser=null,isIOS=!1,limit=null,imgId=null</script> </html>