<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto;background-color:#f2f5f8;color:#333}.aui-list{background-color:transparent}</style> </head> <body> <div id=app class=aui-margin-t-5 v-cloak> <section class=aui-content> <ul class="aui-list aui-media-list"> <li v-for="value in item" class="aui-list-item aui-list-item-middle" tapmode @click=goto(value.activeFun) :style="value.activeFun == 'detail' ? 'margin-bottom: 0.5rem' : '' "> <div class=aui-media-list-item-inner> <div v-if="value.activeFun == 'detail' " class=aui-list-item-media style=width:3.25rem;height:3.5rem> <img id=user-head-img :src=avatar class=aui-img-round style=height:100%;width:100%> </div> <div :class="value.noArrow ? '' : 'aui-list-item-arrow' " class=aui-list-item-inner> <div class=aui-list-item-text> <div class="aui-list-item-title aui-font-size-16">{{ value.itemKey }}</div> <div class="aui-list-item-right aui-font-size-16 tea-text-light-gray aui-ellipsis-1">{{ value.activeFun == 'sex' ? transform : value.itemVal }}</div> </div> </div> </div> </li> </ul> </section> </div> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script type=text/template id=template> </script> <script>function init(){dom={},vm=new Vue({el:"#app",data:{avatar:"../../image/me/default_male.png",sex:$api.getStorage("sex"),item:[{itemKey:"个人主页",itemVal:"进入",activeFun:"detail"},{itemKey:"头像",itemVal:"修改",activeFun:"avatar"},{itemKey:"昵称",itemVal:$api.getStorage("nickname"),activeFun:"nickname"},{itemKey:"性别",itemVal:"",activeFun:"sex"},{itemKey:"手机号码",itemVal:$api.getStorage("telphone"),activeFun:"telphone",noArrow:!0},{itemKey:"我的二维码",itemVal:"",activeFun:"code",noArrow:!0},{itemKey:"个人简介",itemVal:$api.getStorage("profile"),activeFun:"profile"}]},methods:{goto:function(e){switch(e){case"detail":openWinDetail();break;case"avatar":openWinAvatar();break;case"nickname":openWinNickname();break;case"sex":openWinSex();break;case"code":openWinCode();break;case"profile":openWinProfile();break;default:toast()}}},computed:{transform:function(){switch(this.sex){case"female":this.sex="女";break;case"male":this.sex="男";break;default:this.sex="未设置"}return this.sex}}}),getData(),initModule(),initEventListener()}function initModule(){}function initEventListener(){api.addEventListener({name:"save_personal_data"},function(e,a){getData()})}function getData(){tea.showp("加载中...","",!0),api.ajax({url:website+"api.php?action=get_id_by_my_info",method:"post",timeout:30,data:{values:{fid:$api.getStorage("ID")}}},function(e,a){if(api.hideProgress(),!e)return tea.toast("ajax"),!1;e&&($api.setStorage("nickname",e.nickname),$api.setStorage("telphone",e.telphone),$api.setStorage("img",e.img),$api.setStorage("profile",e.profile),vm.avatar=e.img,vm.sex=$api.getStorage("sex"),vm.item[2].itemVal=e.nickname,vm.item[4].itemVal=e.telphone,vm.item[6].itemVal=e.profile)})}function openWinDetail(){tea.openWin({name:"user_info_win",url:"../location/user_info_win.html",pageParam:{friendID:$api.getStorage("ID"),pageType:"me"}})}function openWinAvatar(){tea.openWin({name:"setmylogo_win",url:"./setmylogo_win.html"})}function openWinNickname(){tea.openWin({name:"updata_nickname_win",url:"./updata_nickname_win.html"})}function openWinSex(){tea.openWin({name:"updata_sex_win",url:"./updata_sex_win.html"})}function openWinCode(){tea.openWin({name:"updata_mycode_win",url:"./updata_mycode_win.html"})}function openWinProfile(){tea.openWin({name:"updata_profile_win",url:"./updata_profile_win.html"})}function toast(){api.toast({msg:"暂不支持修改~",duration:2e3,location:"middle"})}var dom={},vm=null;apiready=function(){init()}</script> </html>