<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css></style> </head> <body> <div id=app style=margin-top:1rem v-cloak> <div class=aui-list> <li class=aui-list-item> <div class=aui-list-item-inner> <div class=aui-list-item-input> <input type=text v-model=nickname @keyup.enter=postData> </div> <div class=aui-list-item-label-icon :class="{'aui-hide' : !nickname}" tapmode @click="clear('nickname')"> <i class="aui-iconfont tea-icon-close tea-text-light-gray"></i> </div> </div> </li> </div> </div> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script src=../../script/tea.js></script> <script type=text/template id=template> </script> <script>function init(){dom={},initModule(),initEventListener()}function initModule(){}function initEventListener(){api.addEventListener({name:"saveNickname"},function(a,n){postNickname()})}function postNickname(){var a=$api.trimAll(vm.nickname);""!=a?(showp("数据处理中...",""),api.ajax({url:website+"chsysset.php?action=chnickname",method:"post",timeout:30,data:{values:{ID:vm.ID,token:vm.token,newname:a}}},function(a,n){return api.hideProgress(),a?"ok"==a.succ?(api.sendEvent({name:"save_personal_data"}),api.closeWin(),!0):void api.toast({msg:a.msg,duration:2e3,location:"middle"}):(tea.toast("ajax"),!1)})):alert("请输入昵称")}var dom={},data={},vm=null;apiready=function(){data={nickname:$api.getStorage("nickname"),ID:$api.getStorage("ID"),token:$api.getStorage("token")},vm=new Vue({el:"#app",data:{nickname:data.nickname,ID:data.ID,token:data.token,hide:!0},methods:{clear:function(a){vm[a]=""},postData:function(){postNickname()}},watch:{}}),init()}</script> </html>