<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title>个人详情页</title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{height:100%;overflow:auto;background-color:#f2f5f8}.header{width:100%;background-color:#fff;overflow:hidden}.header-bg-img{width:100%;height:8.15rem;position:relative;webkit-filter:blur(13px) brightness(1) grayscale(.2);filter:blur(13px) brightness(1) grayscale(.2);overflow:hidden}.header-footer-top{width:100%;height:3rem;line-height:3.7rem;text-align:center;display:block}.user-head{width:4rem;height:4rem;position:absolute;top:-2.5rem;left:50%;margin:0 -2rem;border:2px solid #fff;border-radius:9999px;overflow:hidden}.user-head>img{width:100%;height:100%;object-fit:cover}.header-user-name{width:100%;text-align:center;color:#333}.user-rank{padding:0 .4rem;line-height:1.4;font-size:.6rem;color:#fff;background-color:#39f;border-radius:10px}.header-footer-bottom{width:100%;height:auto}.aui-list .aui-list-item-right,.aui-list-item-title-row em{max-width:80%;position:relative;padding:0;padding-left:.75rem;font-size:.6rem;color:#757575;margin:0}.aui-list .aui-list-item-inner{position:relative;min-height:1.2rem;padding-right:.75rem;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-flex:1;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:start}.introduce{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.upload-img{height:0;padding-bottom:100%;background:no-repeat 50%;background-size:cover}.aui-card-list-footer,.aui-card-list-header{position:relative;min-height:2.2rem;padding:.5rem .75rem;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-around;justify-content:space-around;-webkit-box-align:center;-webkit-align-items:center;align-items:center}footer{position:fixed;right:0;bottom:0;left:0}#back{width:1.4rem;height:1.4rem;position:absolute;top:1.4rem;left:.75rem;line-height:1.4rem;text-align:center;color:#fff;background-color:rgba(0,0,0,.5);border-radius:999px;z-index:9999}.icon-close{width:1rem;height:1rem;position:absolute;top:4px;right:4px;text-align:center;line-height:1rem;color:#fff;background-color:rgba(255,0,0,.5)}</style> </head> <body> <div class="aui-card-list header aui-margin-b-10" style=position:relative> <div id=back class="aui-iconfont aui-icon-left" tapmode onclick=closeWin()></div> <div class="aui-card-list-content header-bg-img"> <img id=user-head-bg src=../../image/3.jpg style=width:100%;height:100%;object-fit:cover> </div> <div class=list-footer style="padding:.5rem .75rem;position:relative"> <div class=header-footer-top> <div class=user-head><img id=user-head-img src=../../image/3.jpg alt=头像></div> <div class=header-user-name> <span id=user-name class=user-name></span> <span id=user-rank class=user-rank></span> </div> </div> <div class=header-footer-bottom> <ul class="aui-list aui-list-in aui-list-noborder"> <li> <div class=aui-list-item-inner> <div class="aui-list-item-title aui-font-size-14" style=color:#999>手机号码</div> <div class="aui-list-item-right aui-font-size-14" style=color:#333> <div id=user-phone></div> </div> </div> </li> <li> <div class=aui-list-item-inner style=margin:0;padding:0> <div class="aui-list-item-title aui-font-size-14" style=color:#999>个人简介</div> <div class="aui-list-item-right aui-font-size-14" style=color:#333> <div id=introduce class=introduce>未填写</div> </div> </div> </li> </ul> </div> </div> </div> <div class="aui-list-item-inner aui-padded-10" style=background-color:#fff;margin-bottom:2.5rem> <p>个人风采</p> <div class="aui-row aui-row-padded"> <div id=add-img-btn class=aui-col-xs-4 tapmode onclick=addImg()> <div class=upload-img style=background-image:url(../../image/xinxian_jia@2x.png)></div> </div> </div> </div> <footer> <div class="aui-card-list aui-margin-0"> <div class=aui-card-list-header style=color:#39f> <div id=msgsnd-btn tapmode onclick='tea.toast("disable")'>发消息</div> <div id=look-news-btn tapmode onclick='tea.toast("disable")'>查看新鲜事</div> </div> </div> </footer> </body> <script src=../../script/api.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/doT.min.js></script> <script src=../../script/zepto.min.js></script> <script type=text/template id=template></script> <script>function closeWin(){api.closeWin()}function NewGuid(){function i(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function getNowFormatDate(){var i=new Date,e=i.getFullYear(),a=i.getMonth()+1,t=i.getDate();return a>=1&&a<=9&&(a="0"+a),t>=0&&t<=9&&(t="0"+t),e+"-"+a+"-"+t}function getExt(i){return i.substring(i.lastIndexOf(".")+1)}function imgCompress(i,e,a,t,s){var o=api.cacheDir+"/"+getNowFormatDate()+"/",n=NewGuid()+"."+t;imageFilter.compress({img:i,quality:e,scale:e,save:{album:!1,imgPath:o,imgName:n}},function(i,e){i?s(o+n):alert(JSON.stringify(e))})}function openImageBrowser(i){i=i||0,imageBrowser.openImages({imageUrls:imgs,showList:!1,activeIndex:i})}function checkadd(){$(".upload-imgs").length<6?$("#add-img-btn").show():$("#add-img-btn").hide()}function uploadFile(i,e,a){api.ajax({url:i,method:"post",timeout:30,dataType:"json",returnAll:!1,data:{files:{upfile:e},values:{ID:id}}},function(i,e){i?1==i.statu?a(i.path):0==i.statu&&alert("上传失败"):api.alert({msg:"错误码："+e.code+"；错误信息："+e.msg+"；网络状态码："+e.statusCode})})}function addImg(){api.actionSheet({title:"选择来源",buttons:["相机拍摄","浏览相册"]},function(i,e){switch(i.buttonIndex){case 1:api.getPicture({sourceType:"camera",destinationType:"url",mediaValue:"pic",quality:50,saveToPhotoAlbum:!0},function(i,e){if(i&&i.data){var a=i.data;showp("图片处理中","请稍候..."),imgCompress(a,.5,.5,getExt(a),function(i){uploadFile(website+"upfc.php",i,function(i){imgs.push(website+"userfc_img/"+i);var e='<div class="aui-col-xs-4"><div  tapmode onclick="openImageBrowser()" data-src="'+website+"userfc_img/"+i+'" class="upload-img upload-imgs" style="background-image:url('+website+"userfc_img/"+i+')"></div><div  class="icon-close" data-img="'+website+"userfc_img/"+i+'" data-src="'+i+'" tapmode onclick="closeImg(this)">&times;</div></div>';$api.before($api.byId("add-img-btn"),e),checkadd(),api.parseTapmode(),api.hideProgress()})})}else api.toast({msg:"没有选择，或者选择出错"})});break;case 2:uiMediaScanner.open({type:"picture",column:4,classify:!0,max:1,sort:{key:"time",order:"desc"},texts:{stateText:"已选*项",cancelText:"取消",finishText:"完成"},styles:{bg:"#fff",mark:{icon:"",position:"bottom_left",size:20},nav:{bg:"#b23e4b",stateColor:"#fff",stateSize:18,cancelBg:"rgba(0,0,0,0)",cancelColor:"#fff",cancelSize:18,finishBg:"rgba(0,0,0,0)",finishColor:"#fff",finishSize:18}}},function(i){if(i)for(var e=i.list.length,a=0;a<e;a++)!function(e){var a=i.list[e],t=a.path;a.thumbPath;isIOS?uiMediaScanner.transPath({path:t},function(i){showp("图片处理中","请稍候..."),imgCompress(i.path,.5,.5,a.suffix,function(i){uploadFile(website+"upfc.php",i,function(i){imgs.push(website+"userfc_img/"+i);var e='<div class="aui-col-xs-4" ><div  tapmode onclick="openImageBrowser()" data-src="'+website+"userfc_img/"+i+'" class="upload-img upload-imgs" style="background-image:url('+website+"userfc_img/"+i+')"></div><div  class="icon-close"  data-img="'+website+"userfc_img/"+i+'" data-src="'+i+'" tapmode onclick="closeImg(this)">&times;</div></div>';$api.before($api.byId("add-img-btn"),e),checkadd(),api.parseTapmode(),api.hideProgress()})})}):(showp("图片处理中","请稍候..."),imgCompress(t,.5,.5,a.suffix,function(i){uploadFile(website+"upfc.php",i,function(i){imgs.push(website+"userfc_img/"+i);var e='<div class="aui-col-xs-4" ><div  tapmode onclick="openImageBrowser()" data-src="'+website+"userfc_img/"+i+'" class="upload-img upload-imgs" style="background-image:url('+website+"userfc_img/"+i+')"></div><div  class="icon-close"  data-img="'+website+"userfc_img/"+i+'" data-src="'+i+'" tapmode onclick="closeImg(this)">&times;</div></div>';$api.before($api.byId("add-img-btn"),e),checkadd(),api.parseTapmode(),api.hideProgress()})}))}(a)})}})}function closeImg(i){return api.confirm({title:"温馨提示",msg:"您确定要删除该图片吗？",buttons:["确定","取消"]},function(e,a){1==e.buttonIndex&&api.ajax({url:website+"chsysset.php?action=delfc",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{pic:$(i).attr("data-src")}}},function(e,a){if("ok"==e.succ)return $(i).parent().remove(),api.toast({msg:"删除成功！"}),imgs.remove_arr($(i).attr("data-img")),checkadd(),!1})}),!1}function fnStopPropagation(i){window.event?window.event.cancelBubble=!0:i.stopPropagation()}var uiMediaScanner=null,imageFilter=null,imageBrowser=null,isIOS=!1,id=null,imgs=[];apiready=function(){api.parseTapmode(),uiMediaScanner=api.require("UIMediaScanner"),imageFilter=api.require("imageFilter"),imageBrowser=api.require("imageBrowser"),isIOS="ios"==api.systemType;var i=website+"api.php?action=get_id_by_friends_info",e={fid:id=api.pageParam.id};api.showProgress({title:"正加载中...",text:"先喝杯茶...",modal:!1}),id==$api.getStorage("ID")?($api.byId("msgsnd-btn").style.display="none",$api.byId("add-img-btn").style.display="block",$(".icon-close").show()):($api.byId("msgsnd-btn").style.display="block",$api.byId("add-img-btn").style.display="none",$(".icon-close").hide()),_ajax(i,e,{},function(i){var e=i.nickname,a=i.telphone,t=(i.token,i.ID),s=i.img,o=(i.bimg,i.profile||"未填写"),n=i.tx,r=i.imglist;if($api.attr($api.byId("user-head-bg"),"src",s),$api.attr($api.byId("user-head-img"),"src",s),$api.html($api.byId("user-phone"),a),$api.html($api.byId("introduce"),o),$api.html($api.byId("user-name"),e),$api.html($api.byId("user-rank"),n),r){for(var c=0;c<r.length;c++){var d=website+"userfc_img/"+r[c].pic;imgs.push(d);var p='<div class="aui-col-xs-4" ><div  tapmode onclick="openImageBrowser('+c+')"  data-src="'+website+"userfc_img/"+r[c].pic+'" class="upload-img upload-imgs" style="background-image:url('+website+"userfc_img/"+r[c].pic+')"></div><div  class="icon-close" data-img="'+website+"userfc_img/"+r[c].pic+'" data-src="'+r[c].pic+'" tapmode onclick="closeImg(this);">&times;</div></div>';$api.before($api.byId("add-img-btn"),p),api.parseTapmode()}r.length>5?$("#add-img-btn").hide():$("#add-img-btn").show(),t==$api.getStorage("ID")?($api.byId("msgsnd-btn").style.display="none",$(".icon-close").show()):($api.byId("msgsnd-btn").style.display="block",$(".icon-close").hide())}api.hideProgress()})};var dom={},addimgLen=0,data={},values={};Array.prototype.indexOf=function(i){for(var e=0;e<this.length;e++)if(this[e]==i)return e;return-1},Array.prototype.remove_arr=function(i){var e=this.indexOf(i);e>-1&&this.splice(e,1)}</script> </html>