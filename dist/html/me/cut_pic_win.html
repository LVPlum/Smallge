<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>body,html{width:100%;height:100%;overflow:auto}</style> </head> <body> <header id=header class="aui-bar aui-bar-nav aui-bar-light"> <a class="aui-btn aui-pull-left" tapmode onclick=closeWin()> <span class="aui-iconfont aui-icon-left tea-text-title"></span> </a> <div class="aui-title tea-text-title">裁剪</div> <a class="aui-btn aui-pull-right" tapmode onclick=saveImage()> <span class=tea-text-title>保存</span> </a> </header> <section id=main> <canvas id=can></canvas> </section> <footer id=footer></footer> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script type=text/template id=template></script> <script>function init(){data={src:api.pageParam.data.data},initModule(),initEventListener()}function initModule(){(FNImageClip=api.require("FNImageClip")).open({rect:{x:0,y:headerH,w:api.winWidth,h:api.winHeight-headerH-footerH},srcPath:data.src,highDefinition:!0,style:{mask:"rgba(0, 0, 0, 0.6)",clip:{w:api.winWidth-4,h:api.winWidth-4,x:2,y:.26*api.winWidth,borderColor:"#0f0",borderWidth:0,appearance:"rectangle"}},mode:"image",fixedOn:api.frameName},function(e,a){})}function initEventListener(){}function getData(){}function closeWin(){api.closeWin()}function saveImage(){tea.showp("图像裁剪中...","请稍候..."),FNImageClip.save({destPath:"fs://imageClip/result.png",copyToAlbum:!1,quality:1},function(e,a){e?($api.setStorage("bimg",e.destPath),console.log(api.pageParam.data.data)):(api.hideProgress(),alert(JSON.stringify(a)))}),FNImageClip.save({destPath:"fs://imageClip/result.png",copyToAlbum:!1,quality:.1},function(e,a){e?($api.setStorage("mylogo",e.destPath),api.sendEvent({name:"photo"}),api.closeWin()):(api.hideProgress(),alert(JSON.stringify(a)))})}var header,footer,data={},FNImageClip,headerH,footerH;apiready=function(){header=$api.byId("header"),$api.fixStatusBar(header),headerH=$api.offset(header).h,footer=$api.byId("footer"),footerH=$api.offset(footer).h,init()}</script> </html> 