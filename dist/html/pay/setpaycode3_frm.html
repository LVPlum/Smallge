<!DOCTYPE html> <html> <head> <meta charset=utf-8> <title>支付密码</title> <meta name=viewport content="initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width"/> <meta name=format-detection content="telephone=no,email=no,date=no,address=no"> <link rel=stylesheet type=text/css href=../../css/aui18/aui.css /> <link rel=stylesheet type=text/css href=../../css/common.css /> <style type=text/css>a,body,center,cite,code,dd,del,div,dl,dt,em,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,html,img,input,label,legend,li,mark,ol,p,section,span,strong,textarea,time,ul,var input{margin:0;border:0;padding:0;font-style:normal;color:#323232;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}ol,ul{list-style:none}.content{margin:60px 0 20px;text-align:center}.password{height:40px;line-height:40px;width:240px;margin:0 auto;background-color:#fff}.password span{float:left;width:40px;height:40px;line-height:40px;border:1px solid #ccc;text-align:center}.password span{border-right:none}.password span:last-child{border-right:1px solid #ccc}.keyboard{position:absolute;width:100%;left:0;bottom:0}.keyboard>li{float:left;line-height:50px;width:33.3%;text-align:center;background-color:#fff;-webkit-tap-highlight-color:#ccc}.bottom_border{border-bottom:1px solid #ccc}.top_border{border-top:1px solid #ccc}.right_border{border-right:1px solid #ccc}.fg{text-align:center;padding-top:15px;color:red}.btn{padding:50px 20px 0 20px}</style> </head> <body> <div class=content id=tips> <span style=color:red id=tips>再输入一次支付密码</span> </div> <div class=password> <span></span><span></span><span></span><span></span><span></span><span></span> </div> <div class=btn id=btn></div> <div class=aui-toast style=display:none id=default> <i class="aui-iconfont aui-icon-check"></i> <div class=aui-toast-content>修改成功</div> </div> </body> <script src=../../script/api.js></script> <script src=../../script/conn.js></script> <script>function openinput(){api.require("keyboard").openKeyboard({x:0,y:api.frameHeight-203,fixedOn:api.frameName,fixed:!0},function(a,e){"click"==a.enenType&&(valueArr.push(a.value),updateSpans()),"delete"==a.enenType&&(valueArr.pop(),updateSpans())})}function updateSpans(){for(var a=valueArr.length,e=0;e<spans.length;e++){var n=e<a?"*":"";$api.text(spans[e],n)}a===spans.length&&checkpassword(valueArr.join(""))}function checkpassword(a){if(password1==a){var e='<div class="aui-btn aui-btn-block aui-btn-danger" tapmode onclick="postdate('+a+')">确认设置</div>';$api.html($api.byId("btn"),e)}else $api.text($api.byId("tips"),"两次密码不一致，重新输入"),valueArr=[],updateSpans()}function postdate(a){api.ajax({url:website+"chsysset.php?action=chpaycode",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{ID:ID,token:token,password:a}}},function(e,n){e&&(1==e.succ?($api.remove($api.byId("btn")),showDefault(a)):api.toast({msg:e.msg}))})}function showDefault(a){$api.css($api.byId("default"),"display:block"),setTimeout(function(){$api.css($api.byId("default"),"display:none"),api.sendEvent({name:"paycodeok",extra:{paycode:a}})},2e3)}var UIInput=null,spans=null,valueArr=[],password1=null,ID=null,token=null;apiready=function(){spans=document.querySelector(".password").querySelectorAll("span"),openinput(),password1=api.pageParam.password1,ID=$api.getStorage("ID"),token=$api.getStorage("token")}</script> </html> 