<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta name=viewport content="maximum-scale=1,minimum-scale=1,user-scalable=0,width=device-width,initial-scale=1"/> <meta name=format-detection content="telephone=no,email=no,date=no,aItemress=no"> <title></title> <link rel=stylesheet type=text/css href=../../css/api.css /> <link rel=stylesheet type=text/css href=../../css/aui.css /> <link rel=stylesheet type=text/css href=../../css/aui-skin.css /> <link rel=stylesheet type=text/css href=../../css/tea.css /> <style type=text/css>.aui-checkbox{border-radius:.3rem}li:last-child{margin-bottom:2.2rem}</style> </head> <body> <div class="aui-content aui-content-padded" id=app v-cloak> <ul class="aui-list aui-list-noborder aui-bg-default"> <li v-for="(list , i) in msg" class="aui-list-item aui-padded-0 tea-border-radius-10 aui-margin-b-10"> <div class=aui-row style=width:100%> <div class="aui-col-xs-12 aui-border-b" style="padding:.75rem 0"> <span class=aui-font-size-14 style=margin-left:30px>{{ list[0].week }}</span> <span class=aui-font-size-14>{{ list[0].dctime }}</span> </div> <div class="aui-col-xs-6 aui-text-center" style="padding:.9rem 0"> <span class=aui-font-size-16>{{ list[0].dctype }}</span> <span v-if="list[0].ok==1" class="aui-margin-l-5 aui-checkbox aui-checked" tapmode @click=toggleCheck(i,0);></span> <span v-else class="aui-margin-l-5 aui-checkbox" tapmode @click=toggleCheck(i,0);></span> </div> <div class="aui-col-xs-6 aui-text-center aui-border-l" style="padding:.9rem 0"> <span class=aui-font-size-16>{{ list[1].dctype }}</span> <span v-if="list[1].ok==1" class="aui-margin-l-5 aui-checkbox aui-checked" tapmode @click=toggleCheck(i,1);></span> <span v-else class="aui-margin-l-5 aui-checkbox" tapmode @click=toggleCheck(i,1);></span> </div> </div> </li> </ul> </div> </body> <script src=../../script/api.js></script> <script src=../../script/aui-toast.js></script> <script src=../../script/tea.js></script> <script src=../../script/conn.js></script> <script src=../../script/vue.min.js></script> <script type=text/template id=template> </script> <script>function init(){dom={item:""},data={userid:$api.getStorage("ID"),com:api.pageParam.com,bumen:api.pageParam.bumen,nickname:$api.getStorage("nickname"),telphone:$api.getStorage("telphone"),dc:"",undc:"",value:"",data:!1},vm=new Vue({el:"#app",data:{msg:""},methods:{},methods:{toggleCheck:function(a,t){1==vm.msg[a][t].ok?vm.msg[a][t].ok=0:vm.msg[a][t].ok=1},checkedAll:function(){for(i in vm.msg)vm.msg[i][0].ok=1,vm.msg[i][1].ok=1},unChecked:function(){for(i in vm.msg)vm.msg[i][0].ok=0,vm.msg[i][1].ok=0}}}),api.parseTapmode(),initModule(),initEventListener(),getData()}function initModule(){}function initEventListener(){api.addEventListener({name:"postFood"},function(a,t){for(i in vm.msg)for(k in vm.msg[i])1==vm.msg[i][k].ok?data.dc?data.dc+=","+vm.msg[i][k].dctime+";"+vm.msg[i][k].dctype:data.dc=vm.msg[i][k].dctime+";"+vm.msg[i][k].dctype:data.undc?data.undc+=","+vm.msg[i][k].dctime+";"+vm.msg[i][k].dctype:data.undc=vm.msg[i][k].dctime+";"+vm.msg[i][k].dctype;postData(data.dc,data.undc)})}function getData(){showp("数据加载中...",""),api.ajax({url:website+"fantang/sm/junmafantang.php?action=mulityy",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{userid:data.userid}}},function(a,t){a&&(vm.msg=arrSplit(a,2),vm.msg[0][0].week="明天",vm.msg[1][0].week="后天",api.hideProgress())})}function postData(a,t){showp("数据处理中...",""),api.ajax({url:website+"fantang/sm/junmafantang.php?action=savedc",method:"post",timeout:30,dataType:"json",returnAll:!1,data:{values:{userid:data.userid,dc:a,undc:t,com:data.com,bumen:data.bumen,nickname:data.nickname,telphone:data.telphone}}},function(a,t){a&&1==a.succ&&(api.hideProgress(),showok(),setTimeout(function(){api.sendEvent({name:"reflash"}),api.closeWin({})},2e3))})}function showok(){toast.success({title:"提交成功",duration:2e3})}function arrSplit(a,t){var e=0,i=e+t,n=[],m=a.length;if(i>=m)return n.push(a),n;for(;i<m;)if(n.push(a.slice(e,i)),e+=t,(i=e+t)>=m){i=m,n.push(a.slice(e,i));break}return n}var dom={},vm=null,data={};apiready=function(){init()};var toast=new auiToast({})</script> </html>